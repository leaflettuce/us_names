import csv

reader = csv.reader(open('output\statenames.csv', 'r'))
f = open('StateNamesPerCapita.csv', 'wb')
writer = csv.writer(f)

pop = {
       'AL': {1910 : 1828697, 1950 : 3061743, 1990 : 4040587,
              2000 : 4447100, 2005 : 4530182, 2010 : 4779735},
       'AK': {1910 : 63592, 1950 : 128643, 1990 : 550043,
              2000 : 626932, 2005 : 655435, 2010 : 710231},
       'AZ': {1910 : 122931, 1950 : 749587, 1990 : 3665228,
              2000 : 5130632, 2005 : 5743834, 2010 : 6329013},
       'AR': {1910 : 1311564, 1950 : 1909511, 1990 : 2350725,
              2000 : 2673400, 2005 : 2752629, 2010 : 2915921},
       'CA': {1910 : 1485053, 1950 : 10586223, 1990 : 29760021,
              2000 : 33871648, 2005 : 35893799, 2010 : 37253956},
       'CO': {1910 : 539700, 1950 : 1325089, 1990 : 3294394,
              2000 : 4301261, 2005 : 4601403, 2010 : 5029196},
       'CT': {1910 : 908420, 1950 : 2007280, 1990 : 3287116,
              2000 : 3405565, 2005 : 3503604, 2010 : 3574097},
       'DE': {1910 : 184735, 1950 : 318085, 1990 : 666168,
              2000 : 783600, 2005 : 830364, 2010 : 897934},
       'DC': {1910 : 278718, 1950 : 802178, 1990 : 606900,
              2000 : 572059, 2005 : 553523, 2010 : 601723},
       'FL': {1910 : 528542, 1950 : 2771305, 1990 : 12937926,
              2000 : 15982378, 2005 : 17397161, 2010 : 18801311},
       'GA': {1910 : 2216331, 1950 : 3444578, 1990 : 6478216,
              2000 : 8186453, 2005 : 8829383, 2010 : 9687653},
       'HI': {1910 : 154001, 1950 : 499794, 1990 : 1108229,
              2000 : 1211537, 2005 : 1262840, 2010 : 1360301},
       'ID': {1910 : 161772, 1950 : 588637, 1990 : 1006749,
              2000 : 1293953, 2005 : 1393262, 2010 : 1567582},
       'IL': {1910 : 4821550, 1950 : 8712176, 1990 : 11430602,
              2000 : 12419293, 2005 : 12713634, 2010 : 12830632},
       'IN': {1910 : 2516462, 1950 : 3934224, 1990 : 5544159,
              2000 : 6080485, 2005 : 6237569, 2010 : 6483800},
       'IA': {1910 : 2231853, 1950 : 2621073, 1990 : 2776755,
              2000 : 2926324, 2005 : 2954451, 2010 : 3046350},
       'KS': {1910 : 1470495, 1950 : 1905299, 1990 : 2477574,
              2000 : 2688418, 2005 : 2735502, 2010 : 2853118},
       'KY': {1910 : 2147174, 1950 : 2944806, 1990 : 3685296,
              2000 : 4041769, 2005 : 4145922, 2010 : 4339362},
       'LA': {1910 : 1381625, 1950 : 2683516, 1990 : 4219973,
              2000 : 4468976, 2005 : 4515770, 2010 : 4533372},
       'ME': {1910 : 694466, 1950 : 913774, 1990 : 1227928,
              2000 : 1274923, 2005 : 1317253, 2010 : 1328361},
       'MD': {1910 : 1188044, 1950 : 2343001, 1990 : 4781468,
              2000 : 5296486, 2005 : 5558058, 2010 : 5773552},
       'MA': {1910 : 2805346, 1950 : 4690514, 1990 : 6016425,
              2000 : 6349097, 2005 : 6416505, 2010 : 6547629},
       'MI': {1910 : 2420982, 1950 : 6371766, 1990 : 9295297,
              2000 : 9938444, 2005 : 10112620, 2010 : 9883635},
       'MN': {1910 : 1751394, 1950 : 2982483, 1990 : 4375099,
              2000 : 4919479, 2005 : 5100958, 2010 : 5303925},
       'MS': {1910 : 1551270, 1950 : 2178914, 1990 : 2573216,
              2000 : 2844658, 2005 : 2902966, 2010 : 2967297},
       'MO': {1910 : 3106665, 1950 : 3954653, 1990 : 5117073,
              2000 : 5595211, 2005 : 5754618, 2010 : 5988927},
       'MT': {1910 : 243329, 1950 : 591024, 1990 : 799065,
              2000 : 902195, 2005 : 926865, 2010 : 989415},
       'NE': {1910 : 1066300, 1950 : 1325510, 1990 : 1578385,
              2000 : 1711263, 2005 : 1747214, 2010 : 1826341},
       'NV': {1910 : 42335, 1950 : 160083, 1990 : 1201833,
              2000 : 1998257, 2005 : 2334771, 2010 : 2700551},
       'NH': {1910 : 411588, 1950 : 533242, 1990 : 1109252,
              2000 : 1235786, 2005 : 1299500, 2010 : 1316472},
       'NJ': {1910 : 1883669, 1950 : 4835329, 1990 : 7730188,
              2000 : 8414350, 2005 : 8698879, 2010 : 8791894},
       'NM': {1910 : 195310, 1950 : 681187, 1990 : 1515069,
              2000 : 1819046, 2005 : 1903289, 2010 : 2059180},
       'NY': {1910 : 7268894, 1950 : 14830192, 1990 : 17990455,
              2000 : 18976457, 2005 : 19227088, 2010 : 19378104},
       'NC': {1910 : 1893810, 1950 : 4061929, 1990 : 6628637,
              2000 : 8049313, 2005 : 8541221, 2010 : 9535475},
       'ND': {1910 : 319146, 1950 : 619636, 1990 : 638800,
              2000 : 642200, 2005 : 634366, 2010 : 672591},
       'OH': {1910 : 4157545, 1950 : 7946627, 1990 : 10847115,
              2000 : 11353140, 2005 : 11459011, 2010 : 11536502},
       'OK': {1910 : 790391, 1950 : 2233351, 1990 : 3145585,
              2000 : 3450654, 2005 : 3523553, 2010 : 3751354},
       'OR': {1910 : 413536, 1950 : 1521341, 1990 : 2842321,
              2000 : 3421399, 2005 : 3594586, 2010 : 3831074},
       'PA': {1910 : 6302115, 1950 : 10498012, 1990 : 11881643,
              2000 : 12281054, 2005 : 12406292, 2010 : 12702379},
       'RI': {1910 : 428556, 1950 : 791896, 1990 : 1003464,
              2000 : 1048319, 2005 : 1080632, 2010 : 1052567},
       'SC': {1910 : 1340316, 1950 : 2117027, 1990 : 3486703,
              2000 : 4012012, 2005 : 4198068, 2010 : 4625364},
       'SD': {1910 : 401570, 1950 : 652740, 1990 : 696004,
              2000 : 754844, 2005 : 770883, 2010 : 814180},
       'TN': {1910 : 2020616, 1950 : 3291718, 1990 : 4877185,
              2000 : 5689283, 2005 : 5900962, 2010 : 6346110},
       'TX': {1910 : 3048710, 1950 : 7711194, 1990 : 16986510,
              2000 : 20851820, 2005 : 22490022, 2010 : 25145561},
       'UT': {1910 : 276749, 1950 : 688862, 1990 : 1722850,
              2000 : 2233169, 2005 : 2389039, 2010 : 2763885},
       'VT': {1910 : 343641, 1950 : 377747, 1990 : 562758,
              2000 : 608827, 2005 : 621394, 2010 : 625741},
       'VA': {1910 : 1854184, 1950 : 3318680, 1990 : 6187358,
              2000 : 7078515, 2005 : 7459827, 2010 : 8001024},
       'WA': {1910 : 518103, 1950 : 2378963, 1990 : 4866692,
              2000 : 5894121, 2005 : 6203788, 2010 : 6724540},
       'WV': {1910 : 958800, 1950 : 2005552, 1990 : 1793477,
              2000 : 1808344, 2005 : 1815354, 2010 : 1852996},
       'WI': {1910 : 2069042, 1950 : 3434575, 1990 : 4891769,
              2000 : 5363675, 2005 : 5509026, 2010 : 5686986},
       'WY': {1910 : 92531, 1950 : 290529, 1990 : 453588,
              2000 : 493782, 2005 : 506529, 2010 : 563626},
        }


writer.writerow(next(reader) + ['population', 'perCapita'])
for row in reader:
    if int(row[2]) < 1950:
        year = 1910
    elif int(row[2]) < 1990:
        year = 1950
    elif int(row[2]) < 2000:
        year = 1990
    elif int(row[2]) < 2005:
        year = 2000
    elif int(row[2]) < 2010:
        year = 2005
    elif int(row[2]) >= 2010:
        year = 2010
    population = pop[row[4]][year]
    perCap = float(row[5])/population * 1000
    writer.writerow(row + [population, perCap])
    print row[2], row[4]
f.close()


